---
import { getCollection } from "astro:content";
import Layout from "../../layouts/Layout.astro";

export async function getStaticPaths() {
  const posts = await getCollection("blog");
  return posts.map((post) => ({
    params: { slug: post.slug },
    props: { post },
  }));
}

const { post } = Astro.props;
const { Content } = await post.render();
---

<Layout title={post.data.title} description={post.data.description}>
  <article class="prose prose-gray dark:prose-invert max-w-none">
    <header class="mb-8">
      <h1 class="text-4xl font-bold mb-4">{post.data.title}</h1>
      <time class="text-sm text-gray-500 dark:text-gray-500">
        {
          post.data.date.toLocaleDateString("en-US", {
            year: "numeric",
            month: "long",
            day: "numeric",
          })
        }
      </time>
    </header>

    <div class="mt-8">
      <Content />
    </div>
  </article>

  <div class="mt-12 pt-8 border-t border-gray-200 dark:border-gray-800">
    <a href="/" class="text-blue-600 dark:text-blue-400 hover:underline">
      ‚Üê Back to all posts
    </a>
  </div>
</Layout>

<style is:global>
  .prose {
    color: rgb(31, 41, 55);
  }

  @media (prefers-color-scheme: dark) {
    .prose {
      color: rgb(229, 231, 235);
    }
  }

  .prose pre {
    background-color: rgb(243, 244, 246);
    padding: 1rem;
    border-radius: 0.5rem;
    overflow-x: auto;
  }

  @media (prefers-color-scheme: dark) {
    .prose pre {
      background-color: rgb(17, 24, 39);
    }
  }

  .prose code {
    background-color: rgb(243, 244, 246);
    padding: 0.125rem 0.375rem;
    border-radius: 0.25rem;
    font-size: 0.875rem;
  }

  @media (prefers-color-scheme: dark) {
    .prose code {
      background-color: rgb(17, 24, 39);
    }
  }

  .prose pre code {
    background-color: transparent;
    padding: 0;
  }

  .prose h2 {
    font-size: 1.5rem;
    font-weight: 700;
    margin-top: 2rem;
    margin-bottom: 1rem;
  }

  .prose h3 {
    font-size: 1.25rem;
    font-weight: 600;
    margin-top: 1.5rem;
    margin-bottom: 0.75rem;
  }

  .prose p {
    margin-bottom: 1rem;
    line-height: 1.75;
  }

  .prose ul,
  .prose ol {
    margin-bottom: 1rem;
    margin-left: 1.5rem;
  }

  .prose li {
    margin-bottom: 0.5rem;
  }

  .prose a {
    color: rgb(37, 99, 235);
    text-decoration: underline;
  }

  @media (prefers-color-scheme: dark) {
    .prose a {
      color: rgb(96, 165, 250);
    }
  }

  .prose strong {
    font-weight: 600;
  }
</style>
